{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/controllers/credit-card-list.js","src/js/load.js","src/js/main.js","src/js/services/handlebar-loader.js","src/js/services/smiles-server.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","var $ = require(\"jquery\");\r\n\r\nvar SmilesServer = require(\"../services/smiles-server\");\r\nvar HandlebarLoader = require(\"../services/handlebar-loader\");\r\n\r\n//var Installments = require(\"./installments.js\");\r\n\r\nvar CreditCardListInstance = null;\r\nmodule.exports = class CreditCardList {\r\n  constructor() {\r\n    if(CreditCardListInstance) return CreditCardListInstance;\r\n    this.creditCardList = [];\r\n    this.hb = null;\r\n    CreditCardListInstance = this;\r\n  };\r\n\r\n  load() {\r\n    if(this.creditCardList.lenght > 0) this.loadTemplate();\r\n    else this.reload();\r\n  };\r\n\r\n  processCreditCard(cc) {\r\n    return {\r\n      id: cc.id,\r\n      brand: cc.brand.toLowerCase(),\r\n      last4: String(cc.number).substr(-4),\r\n      active: (cc.main == true)\r\n    };\r\n  };\r\n  refreshCreditCards() {\r\n    let server = new SmilesServer();\r\n    return server.getUserInfo()\r\n      .then((data) => {\r\n        this.creditCardList = data.savedCreditCards.map(this.processCreditCard);\r\n      });\r\n  };\r\n  reload() {\r\n    this.refreshCreditCards().then(() => this.loadTemplate());\r\n  };\r\n\r\n  loadTemplate() {\r\n    if(this.hb == null) {\r\n      this.hb = new HandlebarLoader()\r\n        .loadTemplate(\"sections/credit-card-list\", { cards: this.creditCardList });\r\n    }\r\n    this.hb.into(\"#checkout-step-1\")\r\n      .then(() => this.loadJQuery());\r\n  };\r\n\r\n  selectCard(brand) {\r\n    console.info(\"selected: \", brand);\r\n//    new Installments().selectBrand(brand);\r\n  };\r\n\r\n  loadJQuery() {\r\n    $('input[name=member-card]').on('click', (evt) => {\r\n      let elem = \"#\" + evt.target.id;\r\n      let index = $(elem).data('index');\r\n      let brand = $(elem).data('brand');\r\n      $('.div-secure-code-member-card').hide();\r\n      $('#member-card-list li').removeClass('selected-one-click-card');\r\n      $(elem).closest('li').addClass('selected-one-click-card');\r\n      $('input[id^=secure-code-member-card]').val('');\r\n      if($(elem).is(':checked')){\r\n        $('#div-secure-code-member-card-' + index).show();\r\n      }\r\n      $(elem).closest('li').addClass('selected-one-click-card');\r\n      this.selectCard(brand);\r\n    });\r\n\r\n    $(\"#other-credit-card\").on('click', () => {\r\n//      var AddCreditCard = require(\"./add-credit-card\");\r\n//      new AddCreditCard().load()\r\n    });\r\n  };\r\n\r\n};\r\n","var HandlebarLoader = require(\"./services/handlebar-loader\");\r\n\r\nvar CreditCardList = require(\"./controllers/credit-card-list\");\r\n/*\r\nvar AddCreditCard = require(\"./controllers/add-credit-card\");\r\nvar Installment = require(\"./controllers/installments\");\r\n*/\r\n\r\n$(document).ready(() => {\r\n  let loader = new HandlebarLoader();\r\n  loader.loadTemplate(\"checkout\")\r\n    .into(\"#checkout-token-portlet\")\r\n    .then(() => {\r\n      // step 1:\r\n      new CreditCardList().load();\r\n      // step 2:\r\n//      new Installment().load();\r\n    });\r\n\r\n});\r\n","require(\"./load.js\");\r\n","var $ = require(\"jquery\");\r\nvar Handlebars = require(\"../libs\").Handlebars;\r\n\r\nclass hbTemplate {\r\n  constructor(tname, data) {\r\n    this.name = tname;\r\n    this.data = data;\r\n    this.promise = null;\r\n    this.html = null;\r\n  }\r\n\r\n  start(p) {\r\n    this.promise = p;\r\n  };\r\n  getHtml(fn) { return this.promise.then(fn); };\r\n  append(div) { \r\n    return this.getHtml( h => $(div).append(h) ); \r\n  };\r\n  into (div) { \r\n    return this.getHtml( h => $(div).html(h) ); \r\n  };\r\n\r\n};\r\n\r\nvar HandlebarsInstance = null;\r\nmodule.exports = class HandlebarLoader {\r\n  constructor() {\r\n    if(HandlebarsInstance) return HandlebarsInstance;\r\n    this.templateLocal = \"../src/templates/\";\r\n    this.templateName;\r\n    this.handlebars = Handlebars;\r\n    HandlebarsInstance = this;\r\n  }\r\n\r\n  getTemplateFile(name) {\r\n    return this.templateLocal + name + \".hbs\";\r\n  };\r\n\r\n  createHbTemplate(t, data) {\r\n    return new hbTemplate(t, data);\r\n  }\r\n\r\n  loadTemplate(t, data) {\r\n    let templateObj = this.createHbTemplate(t, data);\r\n    templateObj.start(\r\n      new Promise((resolve, reject) => {\r\n        var xhttp = new XMLHttpRequest();\r\n        let templateFile = this.getTemplateFile(t);\r\n        xhttp.onreadystatechange = () => {\r\n          if(xhttp.readyState == 4) {\r\n            if (xhttp.status == 200) {\r\n              console.info(\"loaded template: \" + templateFile, data);\r\n              let templateScript = this.handlebars.compile(xhttp.responseText);\r\n              let html = templateScript(data);\r\n              resolve(html);\r\n            } else {\r\n              console.info(xhttp);\r\n              reject({\r\n                code: xhttp.status,\r\n                message: xhttp.statusText\r\n              });\r\n            }\r\n          }\r\n        };\r\n        xhttp.open(\"GET\", templateFile, true);\r\n        xhttp.send();\r\n      })\r\n    );\r\n    return templateObj;\r\n  };\r\n\r\n};\r\n","var $ = require(\"jquery\");\r\n\r\nmodule.exports = class SmilesServer {\r\n  constructor() {\r\n    this.host = \"http://localhost.smiles.com.br:8888\";\r\n    this.timeoutTime = 30000;\r\n    this.checkoutToken = \"\";\r\n  }\r\n\r\n  getHeaders () {\r\n    return {\r\n      \"Authorization\": \"Bearer \" + this.checkoutToken,\r\n      \"Channel\": \"APP\",\r\n      \"Content-Type\": \"application/json\"\r\n    };\r\n  }\r\n\r\n  get(url) {\r\n//    console.info(\"server-get: \" + url);\r\n    var defer = new Promise( (resolve, reject) => {\r\n      $.ajax({\r\n        url: url,\r\n        type: \"GET\",\r\n        dataType: \"json\",\r\n        headers: this.getHeaders(),\r\n        timeout: this.timeoutTime,\r\n        success: (data) => resolve(data),\r\n        error: (data) => reject(data)\r\n      });\r\n    });\r\n    return defer;\r\n  };\r\n  post (url, data) {\r\n//    console.info(\"server-post: \" + url, data);\r\n    var defer = new Promise( (resolve, reject) => {\r\n      $.ajax({\r\n        url: url,\r\n        type: \"POST\",\r\n        data: data,\r\n        dataType: \"json\",\r\n        headers: this.getHeaders(),\r\n        timeout: this.timeoutTime,\r\n        success: (data) => resolve(data),\r\n        error: (data) => reject(data)\r\n      });\r\n    });\r\n    return defer;\r\n  };\r\n\r\n  getTokenInfo() {\r\n    let url = this.host + \"/api/oauth/tokeninfo\";\r\n    let defer = new Promise((resolve, reject) => {\r\n      this.get(url)\r\n        .then((data) => {\r\n          resolve(data);\r\n        })\r\n        .catch((err) => reject(err));\r\n    });\r\n    return defer;\r\n  };\r\n  getCheckout() {\r\n    let url = this.host + \"/api/checkout\";\r\n    return this.get(url);\r\n  };\r\n  getUserInfo() {\r\n    let url = this.host + \"/api/user\";\r\n//    return this.get(url);\r\n    return this.fakeCreditCards();\r\n  };\r\n\r\n  fakeCreditCards() {\r\n    return new Promise((resolve, reject) => {\r\n      let ccs = {\r\n        memberNumber: 7777,\r\n        savedCreditCards: [\r\n          {\r\n            id: 1,\r\n            brand: \"VISA\",\r\n            number: \"3015336500590223\",\r\n            main: true\r\n          }, {\r\n            id: 42,\r\n            brand: \"MASTERCARD\",\r\n            number: \"8315179137951987\",\r\n            main: false\r\n          }   \r\n        ]\r\n      };\r\n      resolve(ccs);\r\n    });\r\n  }\r\n\r\n};\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvY29udHJvbGxlcnMvY3JlZGl0LWNhcmQtbGlzdC5qcyIsInNyYy9qcy9sb2FkLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvc2VydmljZXMvaGFuZGxlYmFyLWxvYWRlci5qcyIsInNyYy9qcy9zZXJ2aWNlcy9zbWlsZXMtc2VydmVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7OztBQ0FBLElBQUksSUFBSSxRQUFRLFFBQVIsQ0FBUjs7QUFFQSxJQUFJLGVBQWUsUUFBUSwyQkFBUixDQUFuQjtBQUNBLElBQUksa0JBQWtCLFFBQVEsOEJBQVIsQ0FBdEI7O0FBRUE7O0FBRUEsSUFBSSx5QkFBeUIsSUFBN0I7QUFDQSxPQUFPLE9BQVA7QUFDRSw0QkFBYztBQUFBOztBQUNaLFFBQUcsc0JBQUgsRUFBMkIsT0FBTyxzQkFBUDtBQUMzQixTQUFLLGNBQUwsR0FBc0IsRUFBdEI7QUFDQSxTQUFLLEVBQUwsR0FBVSxJQUFWO0FBQ0EsNkJBQXlCLElBQXpCO0FBQ0Q7O0FBTkg7QUFBQTtBQUFBLDJCQVFTO0FBQ0wsVUFBRyxLQUFLLGNBQUwsQ0FBb0IsTUFBcEIsR0FBNkIsQ0FBaEMsRUFBbUMsS0FBSyxZQUFMLEdBQW5DLEtBQ0ssS0FBSyxNQUFMO0FBQ047QUFYSDtBQUFBO0FBQUEsc0NBYW9CLEVBYnBCLEVBYXdCO0FBQ3BCLGFBQU87QUFDTCxZQUFJLEdBQUcsRUFERjtBQUVMLGVBQU8sR0FBRyxLQUFILENBQVMsV0FBVCxFQUZGO0FBR0wsZUFBTyxPQUFPLEdBQUcsTUFBVixFQUFrQixNQUFsQixDQUF5QixDQUFDLENBQTFCLENBSEY7QUFJTCxnQkFBUyxHQUFHLElBQUgsSUFBVztBQUpmLE9BQVA7QUFNRDtBQXBCSDtBQUFBO0FBQUEseUNBcUJ1QjtBQUFBOztBQUNuQixVQUFJLFNBQVMsSUFBSSxZQUFKLEVBQWI7QUFDQSxhQUFPLE9BQU8s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LGlCQUFTLE9BQU8sR0FBUCxDQUFUO0FBQUEsU0FKVDtBQUtELE9BTlcsQ0FBWjtBQU9BLGFBQU8sS0FBUDtBQUNEO0FBekRIO0FBQUE7QUFBQSxrQ0EwRGdCO0FBQ1osVUFBSSxNQUFNLEtBQUssSUFBTCxHQUFZLGVBQXRCO0FBQ0EsYUFBTyxLQUFLLEdBQUwsQ0FBUyxHQUFULENBQVA7QUFDRDtBQTdESDtBQUFBO0FBQUEsa0NBOERnQjtBQUNaLFVBQUksTUFBTSxLQUFLLElBQUwsR0FBWSxXQUF0QjtBQUNKO0FBQ0ksYUFBTyxLQUFLLGVBQUwsRUFBUDtBQUNEO0FBbEVIO0FBQUE7QUFBQSxzQ0FvRW9CO0FBQ2hCLGFBQU8sSUFBSSxPQUFKLENBQVksVUFBQyxPQUFELEVBQVUsTUFBVixFQUFxQjtBQUN0QyxZQUFJLE1BQU07QUFDUix3QkFBYyxJQUROO0FBRVIsNEJBQWtCLENBQ2hCO0FBQ0UsZ0JBQUksQ0FETjtBQUVFLG1CQUFPLE1BRlQ7QUFHRSxvQkFBUSxrQkFIVjtBQUlFLGtCQUFNO0FBSlIsV0FEZ0IsRUFNYjtBQUNELGdCQUFJLEVBREg7QUFFRCxtQkFBTyxZQUZOO0FBR0Qsb0JBQVEsa0JBSFA7QUFJRCxrQkFBTTtBQUpMLFdBTmE7QUFGVixTQUFWO0FBZ0JBLGdCQUFRLEdBQVI7QUFDRCxPQWxCTSxDQUFQO0FBbUJEO0FBeEZIOztBQUFBO0FBQUEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJ2YXIgJCA9IHJlcXVpcmUoXCJqcXVlcnlcIik7XHJcblxyXG52YXIgU21pbGVzU2VydmVyID0gcmVxdWlyZShcIi4uL3NlcnZpY2VzL3NtaWxlcy1zZXJ2ZXJcIik7XHJcbnZhciBIYW5kbGViYXJMb2FkZXIgPSByZXF1aXJlKFwiLi4vc2VydmljZXMvaGFuZGxlYmFyLWxvYWRlclwiKTtcclxuXHJcbi8vdmFyIEluc3RhbGxtZW50cyA9IHJlcXVpcmUoXCIuL2luc3RhbGxtZW50cy5qc1wiKTtcclxuXHJcbnZhciBDcmVkaXRDYXJkTGlzdEluc3RhbmNlID0gbnVsbDtcclxubW9kdWxlLmV4cG9ydHMgPSBjbGFzcyBDcmVkaXRDYXJkTGlzdCB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBpZihDcmVkaXRDYXJkTGlzdEluc3RhbmNlKSByZXR1cm4gQ3JlZGl0Q2FyZExpc3RJbnN0YW5jZTtcclxuICAgIHRoaXMuY3JlZGl0Q2FyZExpc3QgPSBbXTtcclxuICAgIHRoaXMuaGIgPSBudWxsO1xyXG4gICAgQ3JlZGl0Q2FyZExpc3RJbnN0YW5jZSA9IHRoaXM7XHJcbiAgfTtcclxuXHJcbiAgbG9hZCgpIHtcclxuICAgIGlmKHRoaXMuY3JlZGl0Q2FyZExpc3QubGVuZ2h0ID4gMCkgdGhpcy5sb2FkVGVtcGxhdGUoKTtcclxuICAgIGVsc2UgdGhpcy5yZWxvYWQoKTtcclxuICB9O1xyXG5cclxuICBwcm9jZXNzQ3JlZGl0Q2FyZChjYykge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaWQ6IGNjLmlkLFxyXG4gICAgICBicmFuZDogY2MuYnJhbmQudG9Mb3dlckNhc2UoKSxcclxuICAgICAgbGFzdDQ6IFN0cmluZyhjYy5udW1iZXIpLnN1YnN0cigtNCksXHJcbiAgICAgIGFjdGl2ZTogKGNjLm1haW4gPT0gdHJ1ZSlcclxuICAgIH07XHJcbiAgfTtcclxuICByZWZyZXNoQ3JlZGl0Q2FyZHMoKSB7XHJcbiAgICBsZXQgc2VydmVyID0gbmV3IFNtaWxlc1NlcnZlcigpO1xyXG4gICAgcmV0dXJuIHNlcnZlci5nZXRVc2VySW5mbygpXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jcmVkaXRDYXJkTGlzdCA9IGRhdGEuc2F2ZWRDcmVkaXRDYXJkcy5tYXAodGhpcy5wcm9jZXNzQ3JlZGl0Q2FyZCk7XHJcbiAgICAgIH0pO1xyXG4gIH07XHJcbiAgcmVsb2FkKCkge1xyXG4gICAgdGhpcy5yZWZyZXNoQ3JlZGl0Q2FyZHMoKS50aGVuKCgpID0+IHRoaXMubG9hZFRlbXBsYXRlKCkpO1xyXG4gIH07XHJcblxyXG4gIGxvYWRUZW1wbGF0ZSgpIHtcclxuICAgIGlmKHRoaXMuaGIgPT0gbnVsbCkge1xyXG4gICAgICB0aGlzLmhiID0gbmV3IEhhbmRsZWJhckxvYWRlcigpXHJcbiAgICAgICAgLmxvYWRUZW1wbGF0ZShcInNlY3Rpb25zL2NyZWRpdC1jYXJkLWxpc3RcIiwgeyBjYXJkczogdGhpcy5jcmVkaXRDYXJkTGlzdCB9KTtcclxuICAgIH1cclxuICAgIHRoaXMuaGIuaW50byhcIiNjaGVja291dC1zdGVwLTFcIilcclxuICAgICAgLnRoZW4oKCkgPT4gdGhpcy5sb2FkSlF1ZXJ5KCkpO1xyXG4gIH07XHJcblxyXG4gIHNlbGVjdENhcmQoYnJhbmQpIHtcclxuICAgIGNvbnNvbGUuaW5mbyhcInNlbGVjdGVkOiBcIiwgYnJhbmQpO1xyXG4vLyAgICBuZXcgSW5zdGFsbG1lbnRzKCkuc2VsZWN0QnJhbmQoYnJhbmQpO1xyXG4gIH07XHJcblxyXG4gIGxvYWRKUXVlcnkoKSB7XHJcbiAgICAkKCdpbnB1dFtuYW1lPW1lbWJlci1jYXJkXScpLm9uKCdjbGljaycsIChldnQpID0+IHtcclxuICAgICAgbGV0IGVsZW0gPSBcIiNcIiArIGV2dC50YXJnZXQuaWQ7XHJcbiAgICAgIGxldCBpbmRleCA9ICQoZWxlbSkuZGF0YSgnaW5kZXgnKTtcclxuICAgICAgbGV0IGJyYW5kID0gJChlbGVtKS5kYXRhKCdicmFuZCcpO1xyXG4gICAgICAkKCcuZGl2LXNlY3VyZS1jb2RlLW1lbWJlci1jYXJkJykuaGlkZSgpO1xyXG4gICAgICAkKCcjbWVtYmVyLWNhcmQtbGlzdCBsaScpLnJlbW92ZUNsYXNzKCdzZWxlY3RlZC1vbmUtY2xpY2stY2FyZCcpO1xyXG4gICAgICAkKGVsZW0pLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ3NlbGVjdGVkLW9uZS1jbGljay1jYXJkJyk7XHJcbiAgICAgICQoJ2lucHV0W2lkXj1zZWN1cmUtY29kZS1tZW1iZXItY2FyZF0nKS52YWwoJycpO1xyXG4gICAgICBpZigkKGVsZW0pLmlzKCc6Y2hlY2tlZCcpKXtcclxuICAgICAgICAkKCcjZGl2LXNlY3VyZS1jb2RlLW1lbWJlci1jYXJkLScgKyBpbmRleCkuc2hvdygpO1xyXG4gICAgICB9XHJcbiAgICAgICQoZWxlbSkuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnc2VsZWN0ZWQtb25lLWNsaWNrLWNhcmQnKTtcclxuICAgICAgdGhpcy5zZWxlY3RDYXJkKGJyYW5kKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoXCIjb3RoZXItY3JlZGl0LWNhcmRcIikub24oJ2NsaWNrJywgKCkgPT4ge1xyXG4vLyAgICAgIHZhciBBZGRDcmVkaXRDYXJkID0gcmVxdWlyZShcIi4vYWRkLWNyZWRpdC1jYXJkXCIpO1xyXG4vLyAgICAgIG5ldyBBZGRDcmVkaXRDYXJkKCkubG9hZCgpXHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxufTtcclxuIiwidmFyIEhhbmRsZWJhckxvYWRlciA9IHJlcXVpcmUoXCIuL3NlcnZpY2VzL2hhbmRsZWJhci1sb2FkZXJcIik7XHJcblxyXG52YXIgQ3JlZGl0Q2FyZExpc3QgPSByZXF1aXJlKFwiLi9jb250cm9sbGVycy9jcmVkaXQtY2FyZC1saXN0XCIpO1xyXG4vKlxyXG52YXIgQWRkQ3JlZGl0Q2FyZCA9IHJlcXVpcmUoXCIuL2NvbnRyb2xsZXJzL2FkZC1jcmVkaXQtY2FyZFwiKTtcclxudmFyIEluc3RhbGxtZW50ID0gcmVxdWlyZShcIi4vY29udHJvbGxlcnMvaW5zdGFsbG1lbnRzXCIpO1xyXG4qL1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoKCkgPT4ge1xyXG4gIGxldCBsb2FkZXIgPSBuZXcgSGFuZGxlYmFyTG9hZGVyKCk7XHJcbiAgbG9hZGVyLmxvYWRUZW1wbGF0ZShcImNoZWNrb3V0XCIpXHJcbiAgICAuaW50byhcIiNjaGVja291dC10b2tlbi1wb3J0bGV0XCIpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIC8vIHN0ZXAgMTpcclxuICAgICAgbmV3IENyZWRpdENhcmRMaXN0KCkubG9hZCgpO1xyXG4gICAgICAvLyBzdGVwIDI6XHJcbi8vICAgICAgbmV3IEluc3RhbGxtZW50KCkubG9hZCgpO1xyXG4gICAgfSk7XHJcblxyXG59KTtcclxuIiwicmVxdWlyZShcIi4vbG9hZC5qc1wiKTtcclxuIiwidmFyICQgPSByZXF1aXJlKFwianF1ZXJ5XCIpO1xyXG52YXIgSGFuZGxlYmFycyA9IHJlcXVpcmUoXCIuLi9saWJzXCIpLkhhbmRsZWJhcnM7XHJcblxyXG5jbGFzcyBoYlRlbXBsYXRlIHtcclxuICBjb25zdHJ1Y3Rvcih0bmFtZSwgZGF0YSkge1xyXG4gICAgdGhpcy5uYW1lID0gdG5hbWU7XHJcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgdGhpcy5wcm9taXNlID0gbnVsbDtcclxuICAgIHRoaXMuaHRtbCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBzdGFydChwKSB7XHJcbiAgICB0aGlzLnByb21pc2UgPSBwO1xyXG4gIH07XHJcbiAgZ2V0SHRtbChmbikgeyByZXR1cm4gdGhpcy5wcm9taXNlLnRoZW4oZm4pOyB9O1xyXG4gIGFwcGVuZChkaXYpIHsgXHJcbiAgICByZXR1cm4gdGhpcy5nZXRIdG1sKCBoID0+ICQoZGl2KS5hcHBlbmQoaCkgKTsgXHJcbiAgfTtcclxuICBpbnRvIChkaXYpIHsgXHJcbiAgICByZXR1cm4gdGhpcy5nZXRIdG1sKCBoID0+ICQoZGl2KS5odG1sKGgpICk7IFxyXG4gIH07XHJcblxyXG59O1xyXG5cclxudmFyIEhhbmRsZWJhcnNJbnN0YW5jZSA9IG51bGw7XHJcbm1vZHVsZS5leHBvcnRzID0gY2xhc3MgSGFuZGxlYmFyTG9hZGVyIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIGlmKEhhbmRsZWJhcnNJbnN0YW5jZSkgcmV0dXJuIEhhbmRsZWJhcnNJbnN0YW5jZTtcclxuICAgIHRoaXMudGVtcGxhdGVMb2NhbCA9IFwiLi4vc3JjL3RlbXBsYXRlcy9cIjtcclxuICAgIHRoaXMudGVtcGxhdGVOYW1lO1xyXG4gICAgdGhpcy5oYW5kbGViYXJzID0gSGFuZGxlYmFycztcclxuICAgIEhhbmRsZWJhcnNJbnN0YW5jZSA9IHRoaXM7XHJcbiAgfVxyXG5cclxuICBnZXRUZW1wbGF0ZUZpbGUobmFtZSkge1xyXG4gICAgcmV0dXJuIHRoaXMudGVtcGxhdGVMb2NhbCArIG5hbWUgKyBcIi5oYnNcIjtcclxuICB9O1xyXG5cclxuICBjcmVhdGVIYlRlbXBsYXRlKHQsIGRhdGEpIHtcclxuICAgIHJldHVybiBuZXcgaGJUZW1wbGF0ZSh0LCBkYXRhKTtcclxuICB9XHJcblxyXG4gIGxvYWRUZW1wbGF0ZSh0LCBkYXRhKSB7XHJcbiAgICBsZXQgdGVtcGxhdGVPYmogPSB0aGlzLmNyZWF0ZUhiVGVtcGxhdGUodCwgZGF0YSk7XHJcbiAgICB0ZW1wbGF0ZU9iai5zdGFydChcclxuICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIHZhciB4aHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgIGxldCB0ZW1wbGF0ZUZpbGUgPSB0aGlzLmdldFRlbXBsYXRlRmlsZSh0KTtcclxuICAgICAgICB4aHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XHJcbiAgICAgICAgICBpZih4aHR0cC5yZWFkeVN0YXRlID09IDQpIHtcclxuICAgICAgICAgICAgaWYgKHhodHRwLnN0YXR1cyA9PSAyMDApIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJsb2FkZWQgdGVtcGxhdGU6IFwiICsgdGVtcGxhdGVGaWxlLCBkYXRhKTtcclxuICAgICAgICAgICAgICBsZXQgdGVtcGxhdGVTY3JpcHQgPSB0aGlzLmhhbmRsZWJhcnMuY29tcGlsZSh4aHR0cC5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgIGxldCBodG1sID0gdGVtcGxhdGVTY3JpcHQoZGF0YSk7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShodG1sKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmluZm8oeGh0dHApO1xyXG4gICAgICAgICAgICAgIHJlamVjdCh7XHJcbiAgICAgICAgICAgICAgICBjb2RlOiB4aHR0cC5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiB4aHR0cC5zdGF0dXNUZXh0XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHhodHRwLm9wZW4oXCJHRVRcIiwgdGVtcGxhdGVGaWxlLCB0cnVlKTtcclxuICAgICAgICB4aHR0cC5zZW5kKCk7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIHRlbXBsYXRlT2JqO1xyXG4gIH07XHJcblxyXG59O1xyXG4iLCJ2YXIgJCA9IHJlcXVpcmUoXCJqcXVlcnlcIik7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGNsYXNzIFNtaWxlc1NlcnZlciB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmhvc3QgPSBcImh0dHA6Ly9sb2NhbGhvc3Quc21pbGVzLmNvbS5icjo4ODg4XCI7XHJcbiAgICB0aGlzLnRpbWVvdXRUaW1lID0gMzAwMDA7XHJcbiAgICB0aGlzLmNoZWNrb3V0VG9rZW4gPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgZ2V0SGVhZGVycyAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBcIkF1dGhvcml6YXRpb25cIjogXCJCZWFyZXIgXCIgKyB0aGlzLmNoZWNrb3V0VG9rZW4sXHJcbiAgICAgIFwiQ2hhbm5lbFwiOiBcIkFQUFwiLFxyXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGdldCh1cmwpIHtcclxuLy8gICAgY29uc29sZS5pbmZvKFwic2VydmVyLWdldDogXCIgKyB1cmwpO1xyXG4gICAgdmFyIGRlZmVyID0gbmV3IFByb21pc2UoIChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgJC5hamF4KHtcclxuICAgICAgICB1cmw6IHVybCxcclxuICAgICAgICB0eXBlOiBcIkdFVFwiLFxyXG4gICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLmdldEhlYWRlcnMoKSxcclxuICAgICAgICB0aW1lb3V0OiB0aGlzLnRpbWVvdXRUaW1lLFxyXG4gICAgICAgIHN1Y2Nlc3M6IChkYXRhKSA9PiByZXNvbHZlKGRhdGEpLFxyXG4gICAgICAgIGVycm9yOiAoZGF0YSkgPT4gcmVqZWN0KGRhdGEpXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gZGVmZXI7XHJcbiAgfTtcclxuICBwb3N0ICh1cmwsIGRhdGEpIHtcclxuLy8gICAgY29uc29sZS5pbmZvKFwic2VydmVyLXBvc3Q6IFwiICsgdXJsLCBkYXRhKTtcclxuICAgIHZhciBkZWZlciA9IG5ldyBQcm9taXNlKCAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICQuYWpheCh7XHJcbiAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5nZXRIZWFkZXJzKCksXHJcbiAgICAgICAgdGltZW91dDogdGhpcy50aW1lb3V0VGltZSxcclxuICAgICAgICBzdWNjZXNzOiAoZGF0YSkgPT4gcmVzb2x2ZShkYXRhKSxcclxuICAgICAgICBlcnJvcjogKGRhdGEpID0+IHJlamVjdChkYXRhKVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGRlZmVyO1xyXG4gIH07XHJcblxyXG4gIGdldFRva2VuSW5mbygpIHtcclxuICAgIGxldCB1cmwgPSB0aGlzLmhvc3QgKyBcIi9hcGkvb2F1dGgvdG9rZW5pbmZvXCI7XHJcbiAgICBsZXQgZGVmZXIgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHRoaXMuZ2V0KHVybClcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiByZWplY3QoZXJyKSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBkZWZlcjtcclxuICB9O1xyXG4gIGdldENoZWNrb3V0KCkge1xyXG4gICAgbGV0IHVybCA9IHRoaXMuaG9zdCArIFwiL2FwaS9jaGVja291dFwiO1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0KHVybCk7XHJcbiAgfTtcclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGxldCB1cmwgPSB0aGlzLmhvc3QgKyBcIi9hcGkvdXNlclwiO1xyXG4vLyAgICByZXR1cm4gdGhpcy5nZXQodXJsKTtcclxuICAgIHJldHVybiB0aGlzLmZha2VDcmVkaXRDYXJkcygpO1xyXG4gIH07XHJcblxyXG4gIGZha2VDcmVkaXRDYXJkcygpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGxldCBjY3MgPSB7XHJcbiAgICAgICAgbWVtYmVyTnVtYmVyOiA3Nzc3LFxyXG4gICAgICAgIHNhdmVkQ3JlZGl0Q2FyZHM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaWQ6IDEsXHJcbiAgICAgICAgICAgIGJyYW5kOiBcIlZJU0FcIixcclxuICAgICAgICAgICAgbnVtYmVyOiBcIjMwMTUzMzY1MDA1OTAyMjNcIixcclxuICAgICAgICAgICAgbWFpbjogdHJ1ZVxyXG4gICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICBpZDogNDIsXHJcbiAgICAgICAgICAgIGJyYW5kOiBcIk1BU1RFUkNBUkRcIixcclxuICAgICAgICAgICAgbnVtYmVyOiBcIjgzMTUxNzkxMzc5NTE5ODdcIixcclxuICAgICAgICAgICAgbWFpbjogZmFsc2VcclxuICAgICAgICAgIH0gICBcclxuICAgICAgICBdXHJcbiAgICAgIH07XHJcbiAgICAgIHJlc29sdmUoY2NzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn07XHJcbiJdfQ=="}